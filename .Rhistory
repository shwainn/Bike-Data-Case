library(readxl)
getwd()
bike.data <- read_excel("bikedata.xlsx")
warnings()
View(bike.data)
head(bike.data)
str(bike.data)
bike.data <- bike.data %>%
select(-ride_id)
# altering columns
bike.alter <- bike.data %>%
select(-ride_id)
# altering columns
bike.data <- select(bike.data, -ride_id)
library(tidyverse)
library(tidyr)
library(readxl)
bike.data <- bike.data %>%
select(-ride_id)
View(bike.data)
View(bike.data)
as.factor(bike.data$rideable_type)
as.factor(bike.data$member_casual)
str(bike.data)
bike.data$rideable_type <- as.factor(bike.data$rideable_type)
str(bike.data)
bike.data$member_casual <- as.factor(bike.data$member_casual)
bike.data$member_casual <- as.factor(bike.data$member_casual)
str(bike.data)
str(bike.data$rideable_type)
str(bike.data)
filtered_bike.data <- bike.data %>%
filter(day(started_at) != day(ended_at))
library(lubridate)
filtered_bike.data <- bike.data %>%
filter(day(started_at) != day(ended_at))
View(filtered_bike.data)
filtered_bike.data <- bike.data %>%
filter(day(started_at) != day(ended_at)) %>%
arrange(ended_at)
View(filtered_bike.data)
filtered_bike.data <- bike.data %>%
filter(day(started_at) != day(ended_at)) %>%
arrange(day(ended_at) - day(started_at))
View(filtered_bike.data)
filtered_bike.data <- bike.data %>%
filter(day(ended_at) - day(started_at)<= hours(48)) %>%
arrange(day(ended_at) - day(started_at), desc)
filtered_bike.data <- bike.data %>%
filter((day(ended_at) - day(started_at)) <= hours(48)) %>%
arrange(day(ended_at) - day(started_at), desc)
filtered_bike.data <- bike.data %>%
filter((day(ended_at) - day(started_at)) <= hours(48)) %>%
arrange(day(ended_at) - day(started_at))
filtered_bike.data <- bike.data %>%
filter((day(ended_at) - day(started_at)) <= hours(48)) %>%
arrange(desc(day(ended_at) - day(started_at)))
View(filtered_bike.data)
filtered_bike.data <- bike.data %>%
filter((day(ended_at) - day(started_at)) <= days(2)) %>%
arrange(desc(day(ended_at) - day(started_at)))
View(filtered_bike.data)
filtered_bike.data <- bike.data %>%
filter(ended_at >= started_at + days(2)) %>%
arrange(desc(day(ended_at) - day(started_at)))
View(filtered_bike.data)
filtered_bike.data <- bike.data %>%
filter(ended_at <= started_at + days(2)) %>%
arrange(desc(day(ended_at) - day(started_at)))
View(filtered_bike.data)
filtered_bike.data <- bike.data %>%
filter(ended_at <= started_at + days(2)) %>%
arrange(day(ended_at) - day(started_at))
View(filtered_bike.data)
filtered_bike.data <- bike.data %>%
filter(ended_at <= started_at + days(2)) %>%
arrange(ended_at) - started_at)
filtered_bike.data <- bike.data %>%
filter(ended_at <= started_at + days(2)) %>%
arrange(ended_at - started_at)
View(filtered_bike.data)
filtered_bike.data <- bike.data %>%
filter(ended_at <= started_at + days(2)) %>%
arrange(ended_at - started_at)
filtered_bike.data <- filtered_bike.data %>%
filter(ended_at <= started_at) %>%
arrange(ended_at - started_at)
View(filtered_bike.data)
filtered_bike.data <- filtered_bike.data %>%
filter(ended_at <= started_at) %>%
arrange(ended_at - started_at)
View(filtered_bike.data)
filtered_bike.data <- bike.data %>%
filter(ended_at <= started_at + days(2)) %>%
arrange(ended_at - started_at)
filtered_bike.data <- filtered_bike.data %>%
filter(ended_at > started_at) %>%
arrange(ended_at - started_at)
View(filtered_bike.data)
filtered_bike.data <- bike.data %>%
filter(ended_at > started_at + days(2)) %>%
arrange(ended_at - started_at)
filtered_bike.data <- filtered_bike.data %>%
filter(ended_at > started_at) %>%
arrange(ended_at - started_at)
View(filtered_bike.data)
filtered_bike.data <- bike.data %>%
filter(ended_at > started_at + days(2)) %>%
filter(member_casual == "member")
arrange(ended_at - started_at)
filtered_bike.data <- bike.data %>%
filter(ended_at > started_at + days(2)) %>%
filter(member_casual == "member")
arrange(ended_at - started_at)
filtered_bike.data <- bike.data %>%
filter(ended_at > started_at + days(2)) %>%
filter(member_casual == "member") %>%
arrange(ended_at - started_at)
filtered_bike.data <- filtered_bike.data %>%
filter(ended_at > started_at) %>%
arrange(ended_at - started_at)
View(filtered_bike.data)
filtered_bike.data <- bike.data %>%
filter(ended_at > started_at + days(2)) %>%
arrange(ended_at - started_at)
filtered_bike.data <- filtered_bike.data %>%
filter(ended_at > started_at) %>%
arrange(ended_at - started_at)
View(filtered_bike.data)
filtered_bike.data <- bike.data %>%
filter(ended_at > started_at + days(2)) %>%
arrange(ended_at - started_at)
filtered_bike.data <- filtered_bike.data %>%
filter(ended_at > started_at) %>%
arrange(ended_at - started_at)
filtered_bike.data <- filtered_bike.data %>%
filter(ended_at < started_at + seconds(10)) %>%
arrange(ended_at - started_at)
View(filtered_bike.data)
filtered_bike.data <- bike.data %>%
filter(ended_at <= started_at + days(2)) %>%
arrange(ended_at - started_at)
filtered_bike.data <- filtered_bike.data %>%
filter(ended_at > started_at) %>%
arrange(ended_at - started_at)
filtered_bike.data <- filtered_bike.data %>%
filter(ended_at < started_at + seconds(10)) %>%
arrange(ended_at - started_at)
View(filtered_bike.data)
filtered_bike.data <- bike.data %>%
filter(ended_at <= started_at + days(2)) %>%
arrange(ended_at - started_at)
filtered_bike.data <- filtered_bike.data %>%
filter(ended_at > started_at) %>%
arrange(ended_at - started_at)
filtered_bike.data <- filtered_bike.data %>%
filter(ended_at < started_at + seconds(60)) %>%
arrange(ended_at - started_at)
View(filtered_bike.data)
filtered_bike.data <- bike.data %>%
filter(ended_at <= started_at + days(2)) %>%
arrange(ended_at - started_at)
filtered_bike.data <- filtered_bike.data %>%
filter(ended_at > started_at) %>%
arrange(ended_at - started_at)
filtered_bike.data <- filtered_bike.data %>%
filter(ended_at >= started_at + seconds(60)) %>%
arrange(ended_at - started_at)
View(filtered_bike.data)
filtered_bike.data <- filtered_bike.data %>%
mutate(ride_length = ended_at - started_at)
View(filtered_bike.data)
str(filtered_bike.data)
filtered_bike.data %>%
mutate(displacement = haversine(start_lat, end_lat, start_lng, end_lng))
haversine <- function(lat1, lat2, long1, long2){
p <- pi / 180
a <- sin((lat2 - lat1) / 2) * sin((lat2 - lat1) / 2) +
cos(lat1 * p) * cos(lat2 * p) *
sin((long2 - long1) / 2) * sin((long2 - long1) / 2)
return(2 * 6371 * asin(sqrt(a)))
}
filtered_bike.data %>%
mutate(displacement = haversine(start_lat, end_lat, st
filtered_bike.data %>%
filtered_bike.data %>%
mutate(displacement = haversine(start_lat, end_lat, start_lng, end_lng))
View(filtered_bike.data)
filtered_bike.data <- filtered_bike.data %>%
mutate(displacement = haversine(start_lat, end_lat, start_lng, end_lng))
View(filtered_bike.data)
filtered_bike.data <- filtered_bike.data %>%
mutate(displacement_km = haversine(start_lat, end_lat, start_lng, end_lng))
View(filtered_bike.data)
filtered_bike.data <- filtered_bike.data %>% select(-displacement)
View(filtered_bike.data)
filtered_bike.data <- filtered_bike.data %>%
mutate(displacement_km = haversine(start_lat, end_lat, start_lng, end_lng)) %>%
arrange(desc(displacement_km))
View(filtered_bike.data)
haversine <- function(lat1, lat2, long1, long2){
p <- pi / 180
a <- 0.5 - cos((lat2 - lat1) * p) / 2 +
cos(lat1 * p) * cos(lat2 * p) *
(1 - cos((long2 - long1) * p)) / 2
return(2 * 6371 * asin(sqrt(a)))
}
filtered_bike.data <- filtered_bike.data %>%
mutate(displacement_km = haversine(start_lat, end_lat, start_lng, end_lng)) %>%
arrange(desc(displacement_km))
View(filtered_bike.data)
haversine <- function(lat1, lat2, long1, long2){
p <- pi / 180
a <- sin((lat2 - lat1) * p / 2) * sin((lat2 - lat1) * p / 2) +
cos(lat1 * p) * cos(lat2 * p) *
sin((long2 - long1) * p / 2) * sin((long2 - long1) * p / 2)
return(2 * 6371 * asin(sqrt(a)))
}
filtered_bike.data <- filtered_bike.data %>%
mutate(displacement_km = haversine(start_lat, end_lat, start_lng, end_lng)) %>%
arrange(desc(displacement_km))
filtered_bike.data <- filtered_bike.data %>%
filter(ended_at >= started_at + seconds(60)) %>%
arrange(ended_at - started_at)
View(filtered_bike.data)
# haversine function
haversine <- function(lat1, lat2, long1, long2){
p <- pi / 180
a <- 0.5 - cos((lat2 - lat1) * p) / 2 +
cos(lat1 * p) * cos(lat2 * p) *
(1 - cos((long2 - long1) * p)) / 2
return(2 * 6371 * asin(sqrt(a)))
}
filtered_bike.data <- filtered_bike.data %>%
mutate(displacement_km = haversine(start_lat, end_lat, start_lng, end_lng)) %>%
arrange(desc(displacement_km))
View(filtered_bike.data)
